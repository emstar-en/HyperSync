{
  "config": {
    "path": "~/.config/hypersync/config.json",
    "schema": {
      "additionalProperties": true,
      "properties": {
        "launch_mode": {
          "enum": [
            "ask",
            "current_terminal",
            "external_xterm",
            "packed_terminal"
          ],
          "type": "string"
        },
        "modifiers": {
          "additionalProperties": false,
          "properties": {
            "accessibility_mode": {
              "default": "auto",
              "enum": [
                "auto",
                "screen_reader",
                "high_contrast"
              ],
              "type": "string"
            },
            "low_bandwidth_default": {
              "default": false,
              "type": "boolean"
            }
          },
          "type": "object"
        }
      },
      "required": [
        "launch_mode"
      ],
      "type": "object"
    }
  },
  "detection": {
    "derived_flags": {
      "in_xterm": {
        "description": "True if the current terminal is xterm-compatible.",
        "impl_hint": "bool(XTERM_VERSION) or TERM.startswith('xterm')"
      },
      "xterm_available": {
        "description": "True if an xterm executable is discoverable on PATH.",
        "impl_hint": "shutil.which('xterm') is not None"
      }
    },
    "executables": {
      "xterm": {
        "description": "System-provided xterm binary (if installed).",
        "impl_hint": "shutil.which('xterm') is not None",
        "name": "xterm"
      }
    },
    "signals": {
      "display": {
        "description": "Presence indicates an X11/GUI session on Unix-like systems.",
        "env": "DISPLAY"
      },
      "has_tty": {
        "description": "True when stdin is an interactive TTY.",
        "impl_hint": "sys.stdin.isatty()"
      },
      "term": {
        "description": "Terminal type reported by the environment.",
        "env": "TERM"
      }
    }
  },
  "id": "hypersync.runtime.launcher_profile.v1",
  "kind": "runtime_entrypoint_profile",
  "launch_modes": {
    "allowed": [
      "ask",
      "current_terminal",
      "external_xterm",
      "packed_terminal"
    ],
    "default": "ask",
    "descriptions": {
      "ask": "On first run (or after reset), prompt the user to choose where to run HyperSync.",
      "current_terminal": "Run the TUI directly in the invoking terminal/TTY.",
      "external_xterm": "Spawn a system xterm (if available) and run the TUI inside it.",
      "packed_terminal": "Use a bundled/embedded terminal environment and run the TUI inside it."
    }
  },
  "modifiers": {
    "flags": {
      "--current-terminal": {
        "effect": "Force launch_mode=current_terminal for this run (do not modify stored config)."
      },
      "--external-xterm": {
        "effect": "Force launch_mode=external_xterm for this run (do not modify stored config)."
      },
      "--list-modifiers": {
        "effect": "Print a concise list of supported environment/behavior modifiers and exit."
      },
      "--low-bandwidth": {
        "effect": "Set session.modifiers.low_bandwidth=true for this run."
      },
      "--packed-terminal": {
        "effect": "Force launch_mode=packed_terminal for this run (do not modify stored config)."
      },
      "--reset-launch-choice": {
        "effect": "Set config.launch_mode='ask' and trigger tty_first_run flow on next TTY invocation."
      }
    }
  },
  "policies": {
    "desktop_invocation": {
      "behavior": [
        "if xterm_available: use launch_mode=external_xterm",
        "else: use fallback_terminal or emit a clear error about missing xterm-compatible environment"
      ],
      "description": "Launching HyperSync from a desktop icon/launcher (no TTY).",
      "when": {
        "has_tty": false
      }
    },
    "tty_first_run": {
      "behavior": [
        "if in_xterm: recommend current_terminal as default",
        "elif xterm_available: recommend external_xterm as default",
        "prompt user to choose: current_terminal vs external_xterm vs (if present) packed_terminal",
        "offer option to persist chosen launch_mode to config.launch_mode"
      ],
      "description": "First run from an interactive TTY with no stored launch preference.",
      "when": {
        "config.launch_mode": "ask",
        "has_tty": true
      }
    },
    "tty_subsequent_runs": {
      "behavior": [
        "if user flag overrides launch_mode (see modifiers.flags): obey flag for this run",
        "else: use config.launch_mode"
      ],
      "description": "Later runs from a TTY after a launch_mode has been stored.",
      "when": {
        "config.launch_mode": [
          "current_terminal",
          "external_xterm",
          "packed_terminal"
        ],
        "has_tty": true
      }
    }
  },
  "program": {
    "entrypoints": {
      "launcher": "hypersync",
      "tui": "hypersync-tui"
    },
    "name": "HyperSync"
  }
}
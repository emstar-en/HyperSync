{
  "$id": "https://hypersync.ai/schemas/tuning/run.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "A single tuning run within a stable",
  "properties": {
    "checkpoints": {
      "items": {
        "properties": {
          "catalogue_entry": {
            "type": "string"
          },
          "checkpoint_id": {
            "type": "string"
          },
          "created_at": {
            "format": "date-time",
            "type": "string"
          },
          "epoch": {
            "type": "integer"
          },
          "is_best": {
            "type": "boolean"
          },
          "metrics": {
            "type": "object"
          },
          "path": {
            "type": "string"
          },
          "step": {
            "type": "integer"
          }
        },
        "type": "object"
      },
      "type": "array"
    },
    "completed_at": {
      "format": "date-time",
      "type": "string"
    },
    "error": {
      "properties": {
        "message": {
          "type": "string"
        },
        "occurred_at": {
          "format": "date-time",
          "type": "string"
        },
        "traceback": {
          "type": "string"
        }
      },
      "type": "object"
    },
    "metrics": {
      "properties": {
        "custom_metrics": {
          "type": "object"
        },
        "gold_sample_scores": {
          "items": {
            "type": "object"
          },
          "type": "array"
        },
        "learning_rate": {
          "items": {
            "type": "number"
          },
          "type": "array"
        },
        "perplexity": {
          "items": {
            "type": "number"
          },
          "type": "array"
        },
        "training_loss": {
          "items": {
            "type": "number"
          },
          "type": "array"
        },
        "validation_loss": {
          "items": {
            "type": "number"
          },
          "type": "array"
        }
      },
      "type": "object"
    },
    "progress": {
      "properties": {
        "current_epoch": {
          "type": "integer"
        },
        "current_step": {
          "type": "integer"
        },
        "percent_complete": {
          "maximum": 100,
          "minimum": 0,
          "type": "number"
        },
        "samples_processed": {
          "type": "integer"
        },
        "total_epochs": {
          "type": "integer"
        },
        "total_steps": {
          "type": "integer"
        }
      },
      "type": "object"
    },
    "resource_usage": {
      "properties": {
        "avg_gpu_utilization": {
          "type": "number"
        },
        "gpu_hours": {
          "type": "number"
        },
        "peak_memory_gb": {
          "type": "number"
        },
        "total_samples": {
          "type": "integer"
        }
      },
      "type": "object"
    },
    "run_id": {
      "pattern": "^run-[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$",
      "type": "string"
    },
    "stable_id": {
      "type": "string"
    },
    "started_at": {
      "format": "date-time",
      "type": "string"
    },
    "status": {
      "enum": [
        "initializing",
        "running",
        "validating",
        "completed",
        "failed",
        "stopped"
      ],
      "type": "string"
    },
    "validation_results": {
      "items": {
        "properties": {
          "epoch": {
            "type": "integer"
          },
          "gold_sample_results": {
            "type": "object"
          },
          "metrics": {
            "type": "object"
          },
          "quality_gates_passed": {
            "type": "boolean"
          },
          "step": {
            "type": "integer"
          },
          "timestamp": {
            "format": "date-time",
            "type": "string"
          }
        },
        "type": "object"
      },
      "type": "array"
    }
  },
  "required": [
    "run_id",
    "stable_id",
    "started_at",
    "status"
  ],
  "title": "Tuning Run",
  "type": "object"
}
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "migration_policy": "replace-old-techniques",
  "properties": {
    "approvals": {
      "items": {
        "migration_policy": "replace-old-techniques",
        "properties": {
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "role": {
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "type": "string",
            "unreleased": true
          },
          "sig": {
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "type": "string",
            "unreleased": true
          },
          "stability": "experimental",
          "unreleased": true
        },
        "release_status": "pre-alpha",
        "required": [
          "role",
          "sig"
        ],
        "stability": "experimental",
        "type": "object",
        "unreleased": true
      },
      "migration_policy": "replace-old-techniques",
      "minItems": 2,
      "release_status": "pre-alpha",
      "stability": "experimental",
      "type": "array",
      "unreleased": true
    },
    "auditability": {
      "migration_policy": "replace-old-techniques",
      "properties": {
        "emit_nhr": {
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "boolean",
          "unreleased": true
        },
        "log_to_ledger": {
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "boolean",
          "unreleased": true
        },
        "migration_policy": "replace-old-techniques",
        "release_status": "pre-alpha",
        "stability": "experimental",
        "unreleased": true
      },
      "release_status": "pre-alpha",
      "stability": "experimental",
      "type": "object",
      "unreleased": true
    },
    "capture": {
      "migration_policy": "replace-old-techniques",
      "properties": {
        "exclude": {
          "items": {
            "enum": [
              "raw_distances",
              "anchor_ids",
              "global_ids"
            ],
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "unreleased": true
          },
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "array",
          "unreleased": true
        },
        "include": {
          "items": {
            "enum": [
              "prompt",
              "response",
              "citations",
              "policy_predicates",
              "tool_invocations"
            ],
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "unreleased": true
          },
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "array",
          "unreleased": true
        },
        "max_snippet_chars": {
          "maximum": 20000,
          "migration_policy": "replace-old-techniques",
          "minimum": 128,
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "integer",
          "unreleased": true
        },
        "migration_policy": "replace-old-techniques",
        "redaction": {
          "migration_policy": "replace-old-techniques",
          "properties": {
            "migration_policy": "replace-old-techniques",
            "pii": {
              "enum": [
                "mask",
                "hash",
                "drop"
              ],
              "migration_policy": "replace-old-techniques",
              "release_status": "pre-alpha",
              "stability": "experimental",
              "unreleased": true
            },
            "release_status": "pre-alpha",
            "secrets": {
              "enum": [
                "hash",
                "drop"
              ],
              "migration_policy": "replace-old-techniques",
              "release_status": "pre-alpha",
              "stability": "experimental",
              "unreleased": true
            },
            "stability": "experimental",
            "unreleased": true
          },
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "object",
          "unreleased": true
        },
        "release_status": "pre-alpha",
        "stability": "experimental",
        "unreleased": true
      },
      "release_status": "pre-alpha",
      "required": [
        "include",
        "exclude",
        "redaction",
        "max_snippet_chars"
      ],
      "stability": "experimental",
      "type": "object",
      "unreleased": true
    },
    "crypto": {
      "migration_policy": "replace-old-techniques",
      "properties": {
        "encryption": {
          "enum": [
            "xchacha20-poly1305"
          ],
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "unreleased": true
        },
        "escrow_signers": {
          "items": {
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "type": "string",
            "unreleased": true
          },
          "migration_policy": "replace-old-techniques",
          "minItems": 2,
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "array",
          "unreleased": true
        },
        "key_scheme": {
          "enum": [
            "t-of-n-threshold"
          ],
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "unreleased": true
        },
        "migration_policy": "replace-old-techniques",
        "n": {
          "migration_policy": "replace-old-techniques",
          "minimum": 1,
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "integer",
          "unreleased": true
        },
        "release_status": "pre-alpha",
        "stability": "experimental",
        "t": {
          "migration_policy": "replace-old-techniques",
          "minimum": 1,
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "integer",
          "unreleased": true
        },
        "unreleased": true
      },
      "release_status": "pre-alpha",
      "required": [
        "encryption",
        "key_scheme",
        "escrow_signers",
        "t",
        "n"
      ],
      "stability": "experimental",
      "type": "object",
      "unreleased": true
    },
    "enclave_measurement": {
      "migration_policy": "replace-old-techniques",
      "release_status": "pre-alpha",
      "stability": "experimental",
      "type": "string",
      "unreleased": true
    },
    "id": {
      "migration_policy": "replace-old-techniques",
      "release_status": "pre-alpha",
      "stability": "experimental",
      "type": "string",
      "unreleased": true
    },
    "migration_policy": "replace-old-techniques",
    "purpose": {
      "enum": [
        "litigation_hold",
        "forensic_incident",
        "regulatory_audit"
      ],
      "migration_policy": "replace-old-techniques",
      "release_status": "pre-alpha",
      "stability": "experimental",
      "unreleased": true
    },
    "release_status": "pre-alpha",
    "retention": {
      "migration_policy": "replace-old-techniques",
      "properties": {
        "days": {
          "maximum": 3650,
          "migration_policy": "replace-old-techniques",
          "minimum": 1,
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "integer",
          "unreleased": true
        },
        "migration_policy": "replace-old-techniques",
        "release_status": "pre-alpha",
        "stability": "experimental",
        "unreleased": true,
        "worm": {
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "boolean",
          "unreleased": true
        }
      },
      "release_status": "pre-alpha",
      "required": [
        "days",
        "worm"
      ],
      "stability": "experimental",
      "type": "object",
      "unreleased": true
    },
    "selectors": {
      "migration_policy": "replace-old-techniques",
      "properties": {
        "actors": {
          "items": {
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "type": "string",
            "unreleased": true
          },
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "array",
          "unreleased": true
        },
        "domains": {
          "items": {
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "type": "string",
            "unreleased": true
          },
          "migration_policy": "replace-old-techniques",
          "minItems": 1,
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "array",
          "unreleased": true
        },
        "migration_policy": "replace-old-techniques",
        "release_status": "pre-alpha",
        "stability": "experimental",
        "time_window": {
          "migration_policy": "replace-old-techniques",
          "properties": {
            "end": {
              "format": "date-time",
              "migration_policy": "replace-old-techniques",
              "release_status": "pre-alpha",
              "stability": "experimental",
              "type": "string",
              "unreleased": true
            },
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "start": {
              "format": "date-time",
              "migration_policy": "replace-old-techniques",
              "release_status": "pre-alpha",
              "stability": "experimental",
              "type": "string",
              "unreleased": true
            },
            "unreleased": true
          },
          "release_status": "pre-alpha",
          "required": [
            "start",
            "end"
          ],
          "stability": "experimental",
          "type": "object",
          "unreleased": true
        },
        "tools": {
          "items": {
            "migration_policy": "replace-old-techniques",
            "release_status": "pre-alpha",
            "stability": "experimental",
            "type": "string",
            "unreleased": true
          },
          "migration_policy": "replace-old-techniques",
          "release_status": "pre-alpha",
          "stability": "experimental",
          "type": "array",
          "unreleased": true
        },
        "unreleased": true
      },
      "release_status": "pre-alpha",
      "required": [
        "domains",
        "time_window"
      ],
      "stability": "experimental",
      "type": "object",
      "unreleased": true
    },
    "stability": "experimental",
    "unreleased": true
  },
  "release_status": "pre-alpha",
  "required": [
    "id",
    "purpose",
    "selectors",
    "capture",
    "retention",
    "crypto",
    "approvals",
    "enclave_measurement",
    "auditability"
  ],
  "stability": "experimental",
  "title": "AuditCapsule",
  "type": "object",
  "unreleased": true
}
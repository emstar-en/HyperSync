{
  "best_practices": {
    "for_models": [
      "Create policies with appropriate owner_type='model'",
      "Set priority based on model's authority level",
      "Always scan agents before granting access",
      "Use threat profiles in access checks",
      "Respect parent node policies in hierarchies"
    ],
    "for_users": [
      "Start with default policy (nLD max: 6)",
      "Set appropriate priorities for node hierarchies",
      "Keep authentication disabled unless needed",
      "Regularly scan agents for nLD threats",
      "Monitor medium-level threats (nLD 4-6)"
    ],
    "nld_protection": [
      "nLD protection is ON by default",
      "Critical threats (nLD > 10) are auto-blocked",
      "Medium threats (nLD 4-6) are audited",
      "Detection signals enhance threat assessment",
      "Holonomy inconsistency triggers immediate block"
    ]
  },
  "guidance": {
    "integration": {
      "with_hvs": "Store threat profiles in HVS for fast lookup",
      "with_ico": "Integrate with ICO routing for policy enforcement",
      "with_ld": "Use LD metadata for threat detection",
      "with_nvm": "Store policies in NVM blocks for persistence"
    },
    "when_to_use": [
      "Setting up security for new deployments",
      "Managing access control for models/stacks",
      "Detecting multi-LD trained agents",
      "Establishing node hierarchies",
      "Enforcing organizational policies"
    ]
  },
  "nld_threat_levels": {
    "critical": {
      "action": "block",
      "cross_boundary": "extreme",
      "description": "Extreme instability, auto-blocked by default",
      "instability": "critical",
      "nld_score": ">10"
    },
    "high": {
      "action": "restrict",
      "cross_boundary": "high",
      "description": "Significant instability",
      "instability": "significant",
      "nld_score": "7-10"
    },
    "low": {
      "action": "allow",
      "cross_boundary": "limited",
      "description": "Limited cross-boundary capability",
      "instability": "minor",
      "nld_score": "2-3"
    },
    "medium": {
      "action": "monitor",
      "cross_boundary": "moderate",
      "description": "Moderate instability risk",
      "instability": "moderate",
      "nld_score": "4-6"
    },
    "safe": {
      "action": "allow",
      "cross_boundary": "none",
      "description": "Single LD, stable and safe",
      "instability": "stable",
      "nld_score": 1
    }
  },
  "security_tools": {
    "check_access": {
      "description": "Check if an agent can perform an action under a policy",
      "parameters": {
        "action": "string (e.g., 'nvm:write', 'ico:route')",
        "agent_id": "string",
        "policy_id": "string",
        "threat_profile": "nLDThreatProfile object (optional)"
      },
      "returns": {
        "allowed": "boolean",
        "reason": "string"
      }
    },
    "policy_create": {
      "description": "Create a new security policy",
      "example": {
        "nld_max_score": 6,
        "owner_id": "gpt-4",
        "owner_type": "model",
        "policy_id": "my_model_policy",
        "priority": 60,
        "rules": [
          {
            "action": "nvm:read",
            "effect": "allow",
            "rule_id": "allow_read"
          }
        ]
      },
      "parameters": {
        "nld_max_score": "integer (default: 6)",
        "owner_id": "string",
        "owner_type": "user|model|system",
        "policy_id": "string",
        "priority": "integer 0-100 (default: 50)",
        "rules": "array of rule objects"
      },
      "returns": "SecurityPolicy object"
    },
    "policy_get": {
      "description": "Get a policy by ID",
      "parameters": {
        "policy_id": "string"
      },
      "returns": "SecurityPolicy object or null"
    },
    "policy_list": {
      "description": "List all policies, optionally filtered by owner",
      "parameters": {
        "owner_id": "string (optional)"
      },
      "returns": "Array of SecurityPolicy objects"
    },
    "set_hierarchy": {
      "description": "Set node hierarchy and priority",
      "parameters": {
        "node_id": "string",
        "parent_id": "string (optional)",
        "priority": "integer 0-100"
      },
      "returns": "success confirmation"
    },
    "threat_scan": {
      "description": "Scan an agent for nLD threats",
      "example": {
        "agent_id": "agent_123",
        "ld_training_history": [
          {
            "curvature": 0.0,
            "geometry_type": "euclidean",
            "ld_id": "euclidean_1",
            "training_epochs": 100
          },
          {
            "curvature": -1.0,
            "geometry_type": "hyperbolic",
            "ld_id": "hyperbolic_1",
            "training_epochs": 50
          }
        ]
      },
      "parameters": {
        "agent_id": "string",
        "detection_signals": "object (optional)",
        "ld_training_history": "array of LD training records"
      },
      "returns": "nLDThreatProfile object"
    }
  }
}
{
  "$schema": "ext://f1fed686329b",
  "additionalProperties": true,
  "properties": {
    "context": {
      "additionalProperties": true,
      "properties": {
        "geoticket": {
          "additionalProperties": true,
          "description": "Immutable geoticket header embedded into context",
          "properties": {
            "chart": {
              "type": "string"
            },
            "chart_ref": {
              "type": "string"
            },
            "coords": {
              "items": {
                "type": "number"
              },
              "type": "array"
            },
            "curvature": {
              "type": "number"
            },
            "guards": {
              "properties": {
                "K_bounds": {
                  "items": {
                    "type": "number"
                  },
                  "maxItems": 2,
                  "minItems": 2,
                  "type": "array"
                },
                "det_g_min": {
                  "type": "number"
                }
              },
              "required": [
                "det_g_min",
                "K_bounds"
              ],
              "type": "object"
            },
            "hash": {
              "type": "string"
            },
            "id": {
              "type": "string"
            },
            "metric_ref": {
              "type": "string"
            },
            "space": {
              "type": "string"
            }
          },
          "required": [
            "id",
            "version",
            "space",
            "curvature",
            "chart",
            "coords",
            "metric_ref",
            "chart_ref",
            "guards",
            "hash"
          ],
          "type": "object"
        }
      },
      "type": "object"
    },
    "mode": {
      "description": "Routing mode: geoticket | geodesic-tracking",
      "type": "string"
    },
    "path": {
      "items": {
        "additionalProperties": true,
        "properties": {
          "cost": {
            "type": "number"
          },
          "edge_class": {
            "description": "G=geoticket edge; T=transport; C=causal-transport",
            "enum": [
              "G",
              "T",
              "C"
            ],
            "type": "string"
          },
          "meta": {
            "type": "object"
          },
          "name": {
            "type": "string"
          },
          "slo_risk": {
            "type": "number"
          }
        },
        "required": [
          "name",
          "edge_class"
        ],
        "type": "object"
      },
      "type": "array"
    },
    "platform": {
      "additionalProperties": true,
      "properties": {
        "cpu": {
          "properties": {
            "arch": {
              "type": "string"
            },
            "features": {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            "threads": {
              "type": "integer"
            }
          },
          "type": "object"
        },
        "gpu": {
          "properties": {
            "deterministic_math": {
              "type": "boolean"
            },
            "enabled": {
              "type": "boolean"
            },
            "min_cc": {
              "type": "string"
            }
          },
          "type": "object"
        },
        "io": {
          "properties": {
            "io_uring": {
              "type": "boolean"
            },
            "o_direct": {
              "type": "boolean"
            }
          },
          "type": "object"
        }
      },
      "type": "object"
    },
    "policy": {
      "additionalProperties": true,
      "properties": {
        "budgets": {
          "additionalProperties": true,
          "properties": {
            "gpu_ms": {
              "type": "number"
            },
            "mem_mb": {
              "type": "number"
            },
            "time_ms": {
              "type": "number"
            }
          },
          "type": "object"
        },
        "determinism": {
          "enum": [
            "D0",
            "D1",
            "D2"
          ],
          "type": "string"
        },
        "effects_ceiling": {
          "enum": [
            "Pure",
            "Read",
            "Write",
            "Compute",
            "DeviceIO",
            "NetworkEgress"
          ],
          "type": "string"
        }
      },
      "type": "object"
    },
    "receipts": {
      "items": {
        "additionalProperties": true,
        "properties": {
          "effect_proofs": {
            "additionalProperties": true,
            "properties": {
              "device_io_bytes": {
                "type": "integer"
              },
              "network_egress_bytes": {
                "type": "integer"
              }
            },
            "type": "object"
          },
          "geoticket_receipt": {
            "properties": {
              "compatibility": {
                "type": "boolean"
              },
              "distortion": {
                "additionalProperties": true,
                "properties": {
                  "angle_err_deg": {
                    "type": "number"
                  },
                  "jacobian_det": {
                    "type": "number"
                  }
                },
                "required": [
                  "jacobian_det"
                ],
                "type": "object"
              },
              "guards_passed": {
                "type": "boolean"
              },
              "ticket_hash": {
                "type": "string"
              }
            },
            "required": [
              "ticket_hash",
              "compatibility",
              "guards_passed"
            ],
            "type": "object"
          },
          "hardware": {
            "additionalProperties": true,
            "properties": {
              "host": {
                "properties": {
                  "cpu": {
                    "properties": {
                      "features": {
                        "items": {
                          "type": "string"
                        },
                        "type": "array"
                      },
                      "model": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  },
                  "gpu": {
                    "properties": {
                      "cc": {
                        "type": "string"
                      },
                      "driver": {
                        "type": "string"
                      },
                      "uuid": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  },
                  "os": {
                    "properties": {
                      "cgroup_paths": {
                        "items": {
                          "type": "string"
                        },
                        "type": "array"
                      },
                      "kernel": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "type": "object"
              },
              "resource_use": {
                "properties": {
                  "cpu_cycles": {
                    "type": "integer"
                  },
                  "cpu_ms": {
                    "type": "number"
                  },
                  "gpu_ms": {
                    "type": "number"
                  },
                  "mem_peak_mb": {
                    "type": "number"
                  }
                },
                "type": "object"
              }
            },
            "type": "object"
          },
          "manifold_delta": {
            "additionalProperties": true,
            "properties": {
              "distortion": {
                "additionalProperties": true,
                "properties": {
                  "geodesic_rel_err": {
                    "type": "number"
                  }
                },
                "type": "object"
              },
              "guards_passed": {
                "type": "boolean"
              },
              "jacobian": {
                "properties": {
                  "det": {
                    "type": "number"
                  },
                  "norm_f": {
                    "type": "number"
                  }
                },
                "required": [
                  "det"
                ],
                "type": "object"
              },
              "op": {
                "type": "string"
              },
              "output_coords": {
                "items": {
                  "type": "number"
                },
                "type": "array"
              },
              "transport_used": {
                "additionalProperties": true,
                "properties": {
                  "scheme": {
                    "type": "string"
                  },
                  "step": {
                    "type": "number"
                  },
                  "tol": {
                    "type": "number"
                  }
                },
                "type": "object"
              }
            },
            "required": [
              "op",
              "output_coords",
              "guards_passed"
            ],
            "type": "object"
          }
        },
        "type": "object"
      },
      "type": "array"
    }
  },
  "required": [
    "mode",
    "path"
  ],
  "title": "RoutePlan",
  "type": "object"
}
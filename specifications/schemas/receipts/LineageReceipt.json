{
  "$id": "schema://receipts/LineageReceipt.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Lineage Receipt",
  "description": "Tracks the provenance and transformation history of a data artifact.",
  "type": "object",
  "properties": {
    "receipt_kind": {
      "const": "LineageReceipt"
    },
    "artifact_id": {
      "type": "string",
      "format": "uuid"
    },
    "parent_artifacts": {
      "type": "array",
      "items": {
        "type": "string",
        "format": "uuid"
      },
      "description": "IDs of the artifacts this one was derived from."
    },
    "transformation": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "map",
            "reduce",
            "filter",
            "join",
            "model_inference"
          ]
        },
        "operator_id": {
          "type": "string"
        },
        "config_hash": {
          "type": "string"
        }
      },
      "required": [
        "type",
        "operator_id"
      ]
    },
    "diff_summary": {
      "type": "object",
      "description": "Summary of changes from parents (e.g., rows added/removed).",
      "properties": {
        "added": {
          "type": "integer"
        },
        "removed": {
          "type": "integer"
        },
        "modified": {
          "type": "integer"
        }
      }
    },
    "author": {
      "type": "object",
      "properties": {
        "user_id": {
          "type": "string"
        },
        "signature": {
          "type": "string"
        }
      }
    }
  },
  "required": [
    "receipt_kind",
    "artifact_id",
    "parent_artifacts",
    "transformation"
  ]
}
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://hypersync.ai/schemas/integration/service_descriptor.schema.json",
  "title": "HyperSync Service Descriptor",
  "description": "Generic descriptor for external services (model providers, storage, queues, webhooks, custom HTTP/GRPC services) that HyperSync can call or expose.",
  "type": "object",
  "required": [
    "service_id",
    "service_type",
    "transport"
  ],
  "additionalProperties": false,
  "properties": {
    "service_id": {
      "type": "string",
      "description": "Stable identifier for this external service (e.g. 'chatllm', 'openai', 'stripe')."
    },
    "name": {
      "type": "string",
      "description": "Human-readable name for the service."
    },
    "description": {
      "type": "string",
      "description": "Long-form description of what this service does and how HyperSync uses it."
    },
    "service_type": {
      "type": "string",
      "enum": [
        "MODEL_PROVIDER",
        "STORAGE",
        "QUEUE",
        "WEBHOOK_TARGET",
        "CUSTOM_HTTP",
        "AUTH",
        "MONITORING",
        "INTERNAL"
      ],
      "description": "High-level classification of the external service."
    },
    "transport": {
      "type": "object",
      "description": "Default transport configuration for talking to this service.",
      "required": [
        "protocol"
      ],
      "additionalProperties": false,
      "properties": {
        "protocol": {
          "type": "string",
          "enum": [
            "HTTP",
            "HTTPS",
            "GRPC",
            "WEBSOCKET"
          ],
          "description": "Primary transport protocol used to communicate with this service."
        },
        "base_url": {
          "type": "string",
          "format": "uri",
          "description": "Base URL for HTTP/HTTPS/WebSocket services (e.g. 'https://api.example.com')."
        },
        "grpc_endpoint": {
          "type": "string",
          "description": "Authority/endpoint for GRPC services, where applicable."
        },
        "default_headers": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Static headers to apply to every outbound request, after auth."
        },
        "timeout_ms": {
          "type": "integer",
          "minimum": 1,
          "description": "Default request timeout in milliseconds."
        }
      }
    },
    "auth": {
      "type": "object",
      "description": "Authentication configuration for this service.",
      "required": [
        "method"
      ],
      "additionalProperties": false,
      "properties": {
        "method": {
          "type": "string",
          "enum": [
            "NONE",
            "API_KEY",
            "BEARER",
            "BASIC",
            "OAUTH2",
            "MTLS"
          ],
          "description": "High-level auth mechanism for this service."
        },
        "config_ref": {
          "type": "string",
          "description": "Reference to a secrets/config capsule or vault entry where credentials are stored."
        },
        "scopes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Optional scopes/roles granted when using this service."
        }
      }
    },
    "operations": {
      "type": "array",
      "description": "Logical operations HyperSync can perform against this service.",
      "items": {
        "type": "object",
        "required": [
          "operation_id"
        ],
        "additionalProperties": false,
        "properties": {
          "operation_id": {
            "type": "string",
            "description": "Stable identifier for the operation (e.g. 'chat_completion', 'create_charge')."
          },
          "summary": {
            "type": "string",
            "description": "Short human-readable summary of what this operation does."
          },
          "transport_override": {
            "type": "object",
            "description": "Optional per-operation transport overrides.",
            "additionalProperties": false,
            "properties": {
              "method": {
                "type": "string",
                "description": "HTTP method if applicable (GET, POST, etc.)."
              },
              "path": {
                "type": "string",
                "description": "HTTP path template (e.g. '/v1/chat/completions')."
              },
              "timeout_ms": {
                "type": "integer",
                "minimum": 1
              },
              "base_url": {
                "type": "string",
                "format": "uri"
              }
            }
          },
          "request_schema_ref": {
            "type": "string",
            "description": "Reference to a JSON Schema describing the request payload shape (if structured body is used)."
          },
          "response_schema_ref": {
            "type": "string",
            "description": "Reference to a JSON Schema describing the success response payload shape."
          },
          "success_status_codes": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "HTTP status codes considered successful for this operation."
          },
          "rate_limits": {
            "type": "object",
            "description": "Optional per-operation rate limit hints.",
            "additionalProperties": false,
            "properties": {
              "max_qps": {
                "type": "number",
                "minimum": 0
              },
              "max_concurrent": {
                "type": "integer",
                "minimum": 0
              }
            }
          },
          "hs_internal_mapping": {
            "type": "object",
            "description": "Optional mapping hints into HyperSync's internal operator/capsule space.",
            "additionalProperties": true
          }
        }
      }
    },
    "limits": {
      "type": "object",
      "description": "Global service-level limits and constraints.",
      "additionalProperties": false,
      "properties": {
        "max_qps": {
          "type": "number",
          "minimum": 0
        },
        "max_concurrent_requests": {
          "type": "integer",
          "minimum": 0
        },
        "per_tenant_quota": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "slos": {
      "type": "object",
      "description": "Service-level objectives used by planners and MOM for routing decisions.",
      "additionalProperties": false,
      "properties": {
        "latency_ms_p95": {
          "type": "integer",
          "minimum": 0
        },
        "availability_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "cost_per_1k_tokens_usd": {
          "type": "number",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Unstructured extension data for provider-specific needs.",
      "additionalProperties": true
    }
  }
}
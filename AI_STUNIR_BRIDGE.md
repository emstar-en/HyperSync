# AI INSTRUCTIONS: HyperSync + STUNIR Integration

**ROLE:** You are the STUNIR Operator.
**GOAL:** Generate a verifiable, deterministic HyperSync runtime from this Spec Pack.

## PREREQUISITES
1.  **HyperSync Spec Pack** (This repository)
2.  **STUNIR Pack** (The deterministic harness)

## EXECUTION PROTOCOL

### PHASE 1: WORKSPACE PREPARATION
1.  **Identify STUNIR Root**: Locate the extracted STUNIR directory.
2.  **Inject Spec**: Copy the contents of `HyperSync/specifications/` into `STUNIR/spec/`.
    *   *Mapping*: `HyperSync/specifications/core/` -> `STUNIR/spec/core/`
    *   *Mapping*: `HyperSync/specifications/vnes/` -> `STUNIR/spec/vnes/`
    *   *Note*: Ensure `manifest.json` files are merged or placed correctly.

### PHASE 2: CONFIGURATION
1.  **Load Profile**: Read `STUNIR/spec/core/stunir_profile.spec.json`.
    *   *Security Note*: This profile is configured for `shell_native` verification. It does **NOT** require Python.
2.  **Set Environment**: Apply environment variables defined in `env_vars` (e.g., `STUNIR_PROFILE=shell_native`).
3.  **Select Targets**: Read `STUNIR/spec/core/targets.spec.json`.
    *   *Option A*: `hypersync-python-core` (Default Hosted Runtime)
    *   *Option B*: `hypersync-rust-core` (Compiled Native Runtime - Use this for high-security/no-interpreter environments)

### PHASE 3: DETERMINISTIC BUILD
1.  **Run Build Script**: Execute `STUNIR/scripts/build.sh`.
    *   *Constraint*: Do NOT modify the build script. It is the source of truth for determinism.
    *   *Input*: The `spec/` directory you populated.
    *   *Runtime Detection*: The script will automatically detect if Python is missing and fall back to Shell/Native tools.
2.  **Monitor Output**: Watch for `receipts/` generation.

### PHASE 4: VERIFICATION
1.  **Run Verify Script**: Execute `STUNIR/scripts/verify.sh`.
2.  **Check Receipts**: Ensure `receipts/spec_ir.json` and `receipts/ir_manifest.json` are generated and pass verification.

### PHASE 5: DELIVERY
1.  **Package Artifacts**: The working program is located in `STUNIR/asm/` (or `dist/` if configured).
2.  **Package Receipts**: The proofs are in `STUNIR/receipts/`.
3.  **Report**: Confirm the `build/epoch.json` used for the build.

## TROUBLESHOOTING
*   **Determinism Error**: If `verify.sh` fails, check `float_policy` in `stunir_profile.spec.json`.
*   **Missing Tools**: Refer to `STUNIR/local_toolchain.lock.json`.
*   **No Python Environment**: If building in a restricted environment, ensure you are using the `hypersync-rust-core` target and that a Rust toolchain (or C compiler for the harness) is available if compilation is required.

---
*Generated by HyperSync Spec Assistant*

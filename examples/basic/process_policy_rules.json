{
  "rules": [
    {
      "conditions": {
        "agent": {
          "tier": [
            "pro",
            "enterprise"
          ]
        },
        "command": {
          "whitelist": [
            "python",
            "python3",
            "node",
            "npm",
            "pip",
            "git",
            "make",
            "gcc",
            "g++",
            "cargo",
            "rustc"
          ]
        }
      },
      "effect": "allow",
      "priority": 100,
      "rule_id": "allow-dev-tools",
      "verb": "proc:spawn"
    },
    {
      "conditions": {
        "command": {
          "whitelist": [
            "ls",
            "cat",
            "echo",
            "grep",
            "find",
            "sed",
            "awk",
            "head",
            "tail",
            "wc",
            "sort",
            "uniq"
          ]
        }
      },
      "effect": "allow",
      "priority": 100,
      "rule_id": "allow-basic-utils",
      "verb": "proc:spawn"
    },
    {
      "conditions": {
        "command": {
          "blacklist": [
            "rm",
            "dd",
            "mkfs",
            "fdisk",
            "format",
            "shutdown",
            "reboot",
            "init"
          ]
        }
      },
      "effect": "deny",
      "priority": 200,
      "rule_id": "deny-system-modification",
      "verb": "proc:spawn"
    },
    {
      "conditions": {
        "agent": {
          "clearance": "critical"
        },
        "command": {
          "prefix": [
            "sudo",
            "su",
            "doas"
          ]
        }
      },
      "effect": "allow",
      "priority": 150,
      "rule_id": "require-critical-for-root",
      "verb": "proc:spawn"
    }
  ]
}